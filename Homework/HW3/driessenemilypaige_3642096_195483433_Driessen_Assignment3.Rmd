---
title: "Driessen_Assignment3"
author: "Emily Driessen"
date: "4/8/2022"
output: html_document
editor_options: 
  chunk_output_type: console
---
Using the copus data, make the following plots to the best of your ability (may not be exactly the same if using jittering, default colors, text, titles, exact theme, etc, but should tell the same story). Note: you might have to manipulate the data before you can make the plot. You just need to supply the code for this, no need to actually grab/submit a screen shot or save the plot.

#1 
```{r}
setwd("~/Box/Class Files/Intro to R/Assignment 3") #set working directory to assignment 3 folder

copus <- read_csv("https://raw.githubusercontent.com/jordanharshman/R22/main/data/COPUS.csv") #load copus
library(tidyverse)#load tidyverse
library(dplyr) # load dplyr
library("tidyr") #load tidyr
library(ggplot2) #load ggplot

### --- pH --- ### You do not need to load dplyr, tidyr, or ggplot2 they are loaded by tidyverse

ggplot(copus, aes(y = Lec, fill = Lec)) +
  geom_boxplot() #creates boxplot of the time spent on lecture for all disciplines and instructors together. There is no x-axis value that is meaningful.
```

#2
```{r}
#edit dataset first to create a count of each of the class sizes for each class in the copus dataset
copus1<-copus %>%
  count(Size) %>% #count the number of classes in each class size category (small, medium, and large and create a dataset with that information)
filter(!is.na(Size)) %>% #filter out the NA category. 
rename(Count = "n")#rename the column n as Count
  #Now the dataset looks good to graph.

ggplot(copus1, aes(x = Size, y= Count, fill = Size)) + # map data
  geom_col(position = "dodge") 

### --- pH --- ### You defined a fill aes, I did not; that is a constant throughout your assignment,
### but maybe you were thinking I was just printing the ecopy in greyscale?
```

#3
```{r}
#edit dataset first to create a count of each of the class sizes for each class in the copus dataset
copus2<-copus %>%
  count(Broader, Size) %>% #count the number of classes in each class size category (small, medium, and large and create a dataset with that information)
filter(!is.na(Size)) %>% #filter out the NA category. 
rename(Count = "n")#rename the column n as Count
  #Now the dataset looks good to graph.

ggplot(copus2, aes(x = Broader, y= Count, fill = Broader)) + # map data
  geom_col(position = "dodge") +
facet_wrap(~Size)

### --- pH --- ### Missing axis text rotation
# -0.5


```

#4
```{r}
copus3<-copus %>%
   group_by(Broader)%>% #group by discipline
   summarise_at(vars(Lec), list(AverageLec = mean)) #calcualte the average lecture by discipline
 
  ggplot(copus3, aes(x = Broader, y= AverageLec)) + # map data
  geom_point() #we want a point plot with the average amount of lecture for each discipline
```
#5
```{r}
 ggplot(copus, aes(x=Broader, y = Lec)) + #this tells r we want a graph of the copus data with the amount of lecture for each discipline. 
 geom_boxplot() + #this tells r we want a boxplot for each discpline
 stat_summary(fun.y=mean, geom="point", shape=20, size=2, color="red", fill="red") #This adds the red dot at the mean lecture time for each discipline

```
#6
```{r}
library(stringr)

copus4<-copus %>%
  unite(disciplinebysize, c(Broader, Size))  %>%
  select(CG:OG, disciplinebysize) %>%   #select only group work behaviors and discipline (broader) 
  pivot_longer(-disciplinebysize, "GroupWork") %>% #pivot, Broader is going to be its own column, and then all other columns aside from this one are named "GroupWork and presented together in one column. 
  rename("Percent"="value") %>%
  separate(disciplinebysize, c("Broader", "Size"), sep="_" ) %>% #undo the unite so that we have a column for both Broader and Size again. 
  filter(!str_detect(Size, 'NA'))  #filter out the NAs in size so we only have three facet plots (large, medium, and small)
  
ggplot(copus4, aes(x = GroupWork, y= Percent, fill = Broader)) + # map data
geom_boxplot() + #use a boxplot graph
facet_wrap(~Size) #create a plot for each of the class sizes. 


```

#7
```{r}
plot=ggplot(copus4, aes(x = GroupWork, y= Percent, fill = Broader)) + # map data
geom_boxplot(outlier.shape = NA) + #use a boxplot graph
ylim(0, 60) +
facet_wrap(~Size) #create a plot for each of the class sizes. 

#df doubled resolution, in inches
ggsave(plot, file="plot.pdf",
       height = 2,
       width = 6,
       units = "in",
       dpi = 200)

### --- pH --- ### Recall that dpi isn't doing anything here
```



